controllers:
  openweb-ui:
    annotations:
      reloader.stakater.com/auto: "true"
    containers:
      openweb-ui:
        image:
          repository: ghcr.io/open-webui/open-webui
          tag: 0.5.20
        env:
          OLLAMA_BASE_URL: http://ollama.ollama.svc.cluster.local:11434
        resources:
          requests:
            cpu: 200m
          limits:
            memory: 2Gi

service:
  openweb-ui:
    controller: openweb-ui
    ports:
      http:
        port: &port 8080

ingress:
  openweb-ui:
    className: nginx
    annotations:
      cert-manager.io/cluster-issuer: "cloudflare-prod"
    hosts:
      - host: openweb-ui.atoca.house
        paths:
          - path: /
            pathType: Prefix
            service:
              identifier: openweb-ui
              port: http
    tls:
      - hosts:
          - openweb-ui.atoca.house
        secretName: openweb-ui-tls

persistence:
  openweb-ui:
    enabled: true
    type: persistentVolumeClaim
    storageClass: longhorn
    accessMode: ReadWriteOnce
    size: 5Gi
    globalMounts:
      - path: /app/backend/data