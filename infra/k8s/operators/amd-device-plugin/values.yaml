---
controllers:
  amd-device-plugin:
    type: daemonset

    containers:
      app:
        image:
          repository: docker.io/rocm/k8s-device-plugin
          tag: 1.31.0.9@sha256:26212c665aab415019cfca7a7f1a5c495a306c1e1e03c88f67dfcfda8e81b6e5

        workingDir: /root

        command: ["./k8s-device-plugin"]

        args: ["-logtostderr=true", "-stderrthreshold=INFO", "-v=5"]

        resources:
          requests:
            cpu: 10m
            memory: 10Mi
          limits:
            memory: 100Mi

        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop: ["ALL"]

service:
  app:
    enabled: false
    controller: amd-device-plugin

persistence:
  sys:
    enabled: true
    type: hostPath
    hostPath: /sys

  device-plugins:
    enabled: true
    type: hostPath
    hostPath: /var/lib/kubelet/device-plugins
