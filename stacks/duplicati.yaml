version: "3.8"

services:
  duplicati:
    image: duplicati/duplicati:2.1.0.125
    container_name: duplicati
    network_mode: bridge
    user: "99:100"
    ports:
      - "8200:8200"
    environment:
      - TZ=Europe/Amsterdam
      - SETTINGS_ENCRYPTION_KEY=$SETTINGS_ENCRYPTION_KEY
      - DUPLICATI__WEBSERVICE_PASSWORD=$DUPLICATI_WEBSERVICE_PASSWORD
    deploy:
      resources:
        limits:
          cpus: "1.0"
          memory: 512M
        reservations:
          cpus: "0.25"
          memory: 256M
    volumes:
      - /mnt/user/backups:/backups
      - /mnt/user:/source
      - /mnt/cache_pool/appdata/duplicati:/config
    restart: unless-stopped
    labels:
      - "net.unraid.docker.icon=https://raw.githubusercontent.com/linuxserver/docker-templates/master/linuxserver.io/img/duplicati-logo.png"
