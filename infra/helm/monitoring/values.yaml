crds:
  enabled: true

alertmanager:
  alertmanagerSpec:
    config:
      global:
        resolve_timeout: 5m
      route:
        group_wait: 30s
        group_interval: 5m
        repeat_interval: 1h
        receiver: 'ntfy-receiver'
        routes:
          - match:
              alertname: Watchdog
            receiver: 'ntfy-receiver'
          - match_re:
              alertname: .*
            receiver: 'ntfy-receiver'
      receivers:
        - name: 'ntfy-receiver'
          webhook_configs:
            - url: 'https://ntfy.atoca.house/rpi-k8s'
              send_resolved: true
    storage:
      volumeClaimTemplate:
        spec:
          storageClassName: longhorn
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 10Gi
    resources:
      requests:
        cpu: "100m"
        memory: "100Mi"
      limits:
        cpu: "200m"
        memory: "200Mi"
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      gethomepage.dev/enabled: "true"
      gethomepage.dev/name: "Alertmanager"
      gethomepage.dev/description: "Alertmanager"
      gethomepage.dev/group: "Dynamic"
      gethomepage.dev/icon: "si-XX-#F46800"
      cert-manager.io/cluster-issuer: "cloudflare-prod"
    hosts:
      - alertmanager.atoca.house
    tls:
      - secretName: alertmanager-tls
        hosts:
          - alertmanager.atoca.house

prometheus:
  prometheusSpec:
    additionalScrapeConfigs:
      - job_name: 'compartilhado-node-exporter'
        scrape_interval: 30s
        static_configs:
          - targets:
            - '192.168.178.160:9100'  # Node Exporter running on NAS
    resources:
      requests:
        cpu: "500m"
        memory: "500Mi"
      limits:
        cpu: "1000m"
        memory: "1000Mi"
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: longhorn
          accessModes: ["ReadWriteOnce"]
          resources:
            requests:
              storage: 20Gi
    # Retention period
    retention: 7d
    retentionSize: "20GB"
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: "cloudflare-prod"
    hosts:
      - prometheus.atoca.house
    tls:
      - secretName: prometheus-tls
        hosts:
          - prometheus.atoca.house

grafana:
  enabled: false
  forceDeployDashboards: true

prometheus-node-exporter:
  resources:
    requests:
      cpu: "50m"
      memory: "50Mi"
    limits:
      cpu: "100m"
      memory: "100Mi"

kube-state-metrics:
  resources:
    requests:
      cpu: "50m"
      memory: "50Mi"
    limits:
      cpu: "100m"
      memory: "100Mi"

prometheus-adapter:
  resources:
    requests:
      cpu: "50m"
      memory: "50Mi"
    limits:
      cpu: "100m"
      memory: "100Mi"
